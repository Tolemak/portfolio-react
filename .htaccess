# Blokuj dostęp do katalogu .git i plików wrażliwych
RedirectMatch 403 \.git
RedirectMatch 403 \.env
RedirectMatch 403 \.htaccess

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Zezwól na wszystkie pliki statyczne (np. po buildzie Vite/React)
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Jeśli ścieżka nie istnieje jako plik/katalog, sprawdź czy to nie jest ścieżka do SPA
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ /index.html [L]

  # Strony błędów
  ErrorDocument 403 /403.html
  ErrorDocument 404 /404.html
</IfModule>

# Jeśli żądanie kończy się na .html i nie istnieje taki plik, pokaż 404
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)\.html$ /404.html [L]
